<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Kutty ma üíñ</title>

  <style>
    :root{
      --bg1:#ff6cab;
      --bg2:#7366ff;
      --bg3:#23d5ab;
      --card: rgba(255,255,255,.92);
      --text:#222;
      --muted:#555;
      --accent:#d81b60;

      --good:#22c55e;
      --warn:#f59e0b;
      --bad:#ef4444;

      --shadow: 0 18px 60px rgba(0,0,0,.18);
      --glow: 0 0 25px rgba(255,105,180,.55);
    }

    *{ box-sizing:border-box; }

    body{
      margin:0;
      height:100vh;
      overflow:hidden;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
    }

    /* Animated gradient background */
    .bg{
      position:fixed; inset:0;
      background: linear-gradient(120deg, var(--bg1), var(--bg2), var(--bg3), var(--bg1));
      background-size: 400% 400%;
      animation: gradient 12s ease infinite;
    }
    @keyframes gradient{
      0%{background-position:0% 50%}
      50%{background-position:100% 50%}
      100%{background-position:0% 50%}
    }

    /* Sparkle overlay */
    .sparkles{
      position:fixed; inset:0;
      pointer-events:none;
      background-image:
        radial-gradient(rgba(255,255,255,.55) 1px, transparent 1.5px),
        radial-gradient(rgba(255,255,255,.35) 1px, transparent 2px);
      background-size: 140px 140px, 90px 90px;
      background-position: 0 0, 40px 60px;
      mix-blend-mode: overlay;
      opacity:.35;
      animation: twinkle 8s ease-in-out infinite;
    }
    @keyframes twinkle{
      0%,100%{opacity:.25; transform:scale(1)}
      50%{opacity:.48; transform:scale(1.02)}
    }

    /* Floating hearts/flowers layer */
    .floaters{
      position:fixed; inset:0;
      pointer-events:none;
      overflow:hidden;
    }
    .floater{
      position:absolute;
      font-size: clamp(18px, 3.5vw, 34px);
      opacity:.9;
      filter: drop-shadow(0 10px 15px rgba(0,0,0,.12));
      animation: floatUp linear forwards;
      will-change: transform, opacity;
    }
    @keyframes floatUp{
      0%   { transform: translateY(105vh) rotate(0deg); opacity:0; }
      12%  { opacity:1; }
      100% { transform: translateY(-20vh) rotate(360deg); opacity:0; }
    }

    /* Canvas FX */
    canvas#fx{
      position:fixed;
      inset:0;
      pointer-events:none;
    }

    .wrap{
      position:relative;
      height:100vh;
      display:grid;
      place-items:center;
      padding:16px;
    }

    .card{
      width:min(760px, 94vw);
      background: var(--card);
      border-radius: 22px;
      padding: 22px 18px 18px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(8px);
      border: 1px solid rgba(255,255,255,.45);
      position:relative;
      overflow:hidden;
    }

    .badge{
      position:absolute;
      top:14px; right:14px;
      background: rgba(255,255,255,.75);
      border:1px solid rgba(255,105,180,.25);
      border-radius:999px;
      padding:8px 12px;
      font-weight:950;
      font-size:12px;
      color:#b91c1c;
      box-shadow: var(--glow);
    }

    h1{
      margin: 6px 0 6px;
      font-size: clamp(24px, 4vw, 42px);
      color: var(--accent);
      text-align:center;
      text-shadow: 0 10px 30px rgba(216,27,96,.18);
    }
    .subtitle{
      margin:0 0 12px;
      text-align:center;
      color:var(--muted);
      font-weight:750;
    }

    .scene{
      display:none;
      animation: pop .35s ease;
    }
    .scene.active{ display:block; }
    @keyframes pop{
      from{ transform: translateY(10px) scale(.985); opacity:.0; }
      to{ transform: translateY(0) scale(1); opacity:1; }
    }

    .toprow{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      margin: 8px 4px 12px;
      flex-wrap:wrap;
    }
    .pill{
      background: rgba(255,255,255,.75);
      border:1px solid rgba(0,0,0,.08);
      padding:8px 12px;
      border-radius:999px;
      font-weight:900;
      font-size:12px;
      box-shadow: 0 10px 25px rgba(0,0,0,.07);
    }
    .score{
      color:#6a1b9a;
    }

    .qbox{
      margin-top:6px;
      border-radius:18px;
      padding:16px;
      background: linear-gradient(135deg, rgba(255,192,203,.35), rgba(173,216,230,.25));
      border: 1px dashed rgba(216,27,96,.25);
    }

    .question{
      font-weight:950;
      font-size:18px;
      text-align:center;
      color:#111;
      margin: 4px 0 12px;
    }

    .options{
      display:grid;
      gap:10px;
      grid-template-columns: 1fr;
      margin: 0 auto;
      width: min(560px, 100%);
    }

    .opt{
      border:none;
      cursor:pointer;
      padding: 14px 14px;
      border-radius: 16px;
      font-weight: 950;
      font-size: 15px;
      background: rgba(255,255,255,.85);
      border:1px solid rgba(0,0,0,.08);
      box-shadow: 0 12px 26px rgba(0,0,0,.10);
      transition: transform .12s ease, filter .2s ease;
      text-align:center;
    }
    .opt:active{ transform: scale(.98); }
    .opt:hover{ filter: brightness(1.02); }

    .opt.good{ outline: 2px solid rgba(34,197,94,.35); }
    .opt.warn{ outline: 2px solid rgba(245,158,11,.30); }
    .opt.bad{ outline: 2px solid rgba(239,68,68,.30); }

    .feedback{
      margin-top: 12px;
      border-radius: 16px;
      padding: 12px 12px;
      background: rgba(255,255,255,.75);
      border: 1px solid rgba(0,0,0,.06);
      box-shadow: 0 10px 25px rgba(0,0,0,.07);
      min-height: 54px;
      display:flex;
      align-items:center;
      justify-content:center;
      text-align:center;
      font-weight:850;
      color:#333;
    }

    .feedback.good{ border-color: rgba(34,197,94,.35); color:#14532d; }
    .feedback.warn{ border-color: rgba(245,158,11,.35); color:#7c2d12; }
    .feedback.bad{ border-color: rgba(239,68,68,.35); color:#7f1d1d; }

    .actions{
      display:flex;
      justify-content:center;
      gap:12px;
      flex-wrap:wrap;
      margin-top: 12px;
    }

    .action{
      border:none;
      cursor:pointer;
      padding: 12px 18px;
      border-radius: 999px;
      font-weight: 950;
      background: rgba(255,255,255,.82);
      border: 1px solid rgba(0,0,0,.08);
      box-shadow: 0 10px 25px rgba(0,0,0,.10);
    }
    .action.primary{
      background: linear-gradient(135deg, #ff4d6d, #ff8fab);
      color:white;
      border:none;
      box-shadow: var(--glow);
    }
    .action:disabled{
      opacity:.55;
      cursor:not-allowed;
    }

    /* Final love scene arena */
    .arena{
      position:relative;
      width: min(620px, 100%);
      height: 210px;
      margin: 10px auto 0;
      border-radius: 18px;
      background: linear-gradient(135deg, rgba(255,192,203,.35), rgba(173,216,230,.25));
      border: 1px dashed rgba(216,27,96,.25);
      overflow:hidden;
    }

    .btn{
      border:none;
      cursor:pointer;
      padding: 14px 26px;
      font-weight: 980;
      border-radius: 999px;
      font-size: 16px;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      box-shadow: 0 10px 22px rgba(0,0,0,.14);
      position:absolute;
      top: 24px;
      white-space: nowrap;
      transition: transform .12s ease, filter .2s ease;
    }
    .btn:active{ transform: scale(.98); }
    #yesBtn{
      background: #22c55e;
      color:white;
      left:50%;
      transform: translateX(-125%);
    }
    #noBtn{
      background: #ff3b5c;
      color:white;
      left:50%;
      transform: translateX(20%);
      touch-action:none;
    }

    .hint{
      margin-top: 10px;
      text-align:center;
      font-size: 12px;
      opacity:.75;
    }

    .finalText{
      margin-top: 10px;
      text-align:center;
      font-weight: 950;
      font-size: 18px;
      color:#6a1b9a;
      min-height: 28px;
    }
  </style>
</head>

<body>
  <div class="bg"></div>
  <div class="sparkles"></div>
  <div class="floaters" id="floaters"></div>
  <canvas id="fx"></canvas>

  <div class="wrap">
    <div class="card">
      <div class="badge">üå∏ For Kutty ma üíñ</div>

      <h1 id="mainTitle">Kutty ma Quiz üòèüíñ</h1>
      <p class="subtitle" id="mainSub">Answer 3 questions‚Ä¶ then comes the final question üòà</p>

      <!-- QUIZ SCENE -->
      <div class="scene active" id="quizScene">
        <div class="toprow">
          <div class="pill" id="progressPill">Question 1 / 3</div>
          <div class="pill score" id="scorePill">Score: 0</div>
        </div>

        <div class="qbox">
          <div class="question" id="qText">Loading...</div>
          <div class="options" id="options"></div>

          <div class="feedback" id="feedback">Pick one option üòè</div>

          <div class="actions">
            <button class="action" id="backBtn" disabled>Back</button>
            <button class="action primary" id="nextBtn" disabled>Next ‚ú®</button>
          </div>
        </div>

        <div class="hint">Cute + troll mix üòåüíò</div>
      </div>

      <!-- LOVE SCENE -->
      <div class="scene" id="loveScene">
        <h1 style="margin-top:0;">Kutty ma, do you love me? üíñ</h1>
        <p class="subtitle">Choose wisely üòè (No button is‚Ä¶ alive)</p>

        <div class="arena" id="arena">
          <button class="btn" id="yesBtn">Yes üòç</button>
          <button class="btn" id="noBtn">No üôÉ</button>
        </div>

        <div class="finalText" id="finalText"></div>

        <div class="actions">
          <button class="action" id="openMaps">Open Maps üó∫Ô∏è</button>
          <button class="action primary" id="closeBtn">Close üíû</button>
        </div>

        <div class="hint">Proposal: Snacks at Aladipattiyan üòãüå∏</div>
      </div>

    </div>
  </div>

  <script>
    /***********************
     * Cute floaters + FX
     ***********************/
    const floaters = document.getElementById("floaters");
    const EMOJIS = ["üíñ","üíò","üíù","‚ù§Ô∏è","üåπ","üå∏","üå∑","‚ú®","ü´∂","ü•∞","üç´","üéÄ"];

    const rand = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;

    function spawnFloaters(count){
      for(let i=0;i<count;i++){
        const el = document.createElement("div");
        el.className = "floater";
        el.textContent = EMOJIS[rand(0, EMOJIS.length-1)];

        const left = rand(0, 100);
        const dur = rand(4500, 9000);
        const delay = rand(0, 600);

        el.style.left = left + "vw";
        el.style.animationDuration = dur + "ms";
        el.style.animationDelay = delay + "ms";
        el.style.opacity = (Math.random() * 0.35 + 0.55).toFixed(2);

        floaters.appendChild(el);
        setTimeout(() => el.remove(), dur + delay + 200);
      }
    }

    // Canvas confetti/fireworks
    const fx = document.getElementById("fx");
    const ctx = fx.getContext("2d");
    let particles = [];

    function resizeFX(){
      fx.width = window.innerWidth * devicePixelRatio;
      fx.height = window.innerHeight * devicePixelRatio;
      ctx.setTransform(devicePixelRatio,0,0,devicePixelRatio,0,0);
    }

    function confettiBurst(n=180){
      const colors = ["#ff4d6d","#ff8fab","#ffd166","#06d6a0","#4cc9f0","#a78bfa","#fb7185","#f472b6"];
      for(let i=0;i<n;i++){
        particles.push({
          x: window.innerWidth/2 + rand(-90,90),
          y: window.innerHeight/2 + rand(-60,60),
          vx: (Math.random()*8-4),
          vy: (Math.random()*-10-3),
          g: 0.22 + Math.random()*0.12,
          r: 2 + Math.random()*4,
          a: 1,
          rot: Math.random()*Math.PI,
          vr: (Math.random()*0.2-0.1),
          c: colors[rand(0, colors.length-1)],
          life: 190 + rand(0,90),
          type: "confetti"
        });
      }
    }

    function fireworks(bursts=2){
      const colors = ["#ffffff","#ffe066","#ff5d8f","#4cc9f0","#c77dff","#06d6a0"];
      for(let b=0;b<bursts;b++){
        const cx = rand(20, 80) * window.innerWidth/100;
        const cy = rand(15, 55) * window.innerHeight/100;
        const count = 90 + rand(0,55);
        for(let i=0;i<count;i++){
          const ang = Math.random()*Math.PI*2;
          const sp = 1.5 + Math.random()*4.8;
          particles.push({
            x: cx, y: cy,
            vx: Math.cos(ang)*sp,
            vy: Math.sin(ang)*sp,
            g: 0.06 + Math.random()*0.05,
            r: 1.2 + Math.random()*2.2,
            a: 1,
            rot: 0, vr: 0,
            c: colors[rand(0, colors.length-1)],
            life: 125 + rand(0,75),
            type: "spark"
          });
        }
      }
    }

    function tickFX(){
      ctx.clearRect(0,0,window.innerWidth,window.innerHeight);
      particles = particles.filter(p => p.life-- > 0 && p.a > 0.02);

      for(const p of particles){
        p.x += p.vx;
        p.y += p.vy;
        p.vy += p.g;
        p.rot += p.vr;
        p.a *= 0.992;

        ctx.save();
        ctx.globalAlpha = p.a;
        ctx.fillStyle = p.c;

        if(p.type === "confetti"){
          ctx.translate(p.x, p.y);
          ctx.rotate(p.rot);
          ctx.fillRect(-p.r, -p.r/2, p.r*2.3, p.r);
        } else {
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
          ctx.fill();
        }
        ctx.restore();
      }
      requestAnimationFrame(tickFX);
    }

    /***********************
     * Quiz Data (your logic)
     ***********************/
    const QUESTIONS = [
      {
        q: "When I pinged you first time? üòå",
        options: [
          {
            label: "Feb 15 ‚Äî 5:30 o'clock ‚úÖ",
            grade: "good",
            correct: true,
            msg: "Ayyy Kutty ma ü•∫üíñ perfect memory! That moment is special for me."
          },
          {
            label: "Feb 15 ‚Äî 5:15 o'clock",
            grade: "bad",
            correct: false,
            msg: "Ayo üò§ wrong! You forgot my first ping ah? Hmm suspicious üòè"
          },
          {
            label: "Feb 15 ‚Äî 6:00 o'clock",
            grade: "bad",
            correct: false,
            msg: "Eiii üò§ not this time! Think properly Kutty ma üòå"
          }
        ]
      },
      {
        q: "What‚Äôs my fav food? üòã",
        options: [
          {
            label: "Dosa ü•ûüíñ",
            grade: "good",
            correct: true,
            msg: "Awww YESSS üò≠üíñ Dosa is love! You know me too well, Kutty ma ü´∂"
          },
          {
            label: "Briyani üçóüôÇ",
            grade: "warn",
            correct: false,
            msg: "Hmm‚Ä¶ briyani is nice üòå but not my #1. You‚Äôre average today üòÇ"
          },
          {
            label: "Rasam üç≤üòÖ",
            grade: "warn",
            correct: false,
            msg: "Rasam ah? ok ok üòÖ not bad‚Ä¶ but still wrong, Kutty ma üòè"
          }
        ]
      },
      {
        q: "Where we went for your bday? üéÇ",
        options: [
          {
            label: "Temple + Beach üå∏üèñÔ∏è ‚úÖ",
            grade: "good",
            correct: true,
            msg: "Kutty maaaa üò≠üíñ correct! I love how simple and peaceful that day was with you."
          },
          {
            label: "Beach + Ice cream üèñÔ∏èüç¶",
            grade: "bad",
            correct: false,
            msg: "Adei üò§ wrong! Ice cream is ok, but you forgot the main plan ah?"
          },
          {
            label: "Temple + Shopping üå∏üõçÔ∏è",
            grade: "bad",
            correct: false,
            msg: "No no üò§ shopping illa! Think again Kutty ma üòè"
          }
        ]
      }
    ];

    /***********************
     * Quiz Engine
     ***********************/
    const quizScene = document.getElementById("quizScene");
    const loveScene = document.getElementById("loveScene");

    const qText = document.getElementById("qText");
    const optionsEl = document.getElementById("options");
    const feedbackEl = document.getElementById("feedback");

    const progressPill = document.getElementById("progressPill");
    const scorePill = document.getElementById("scorePill");

    const backBtn = document.getElementById("backBtn");
    const nextBtn = document.getElementById("nextBtn");

    const mainTitle = document.getElementById("mainTitle");
    const mainSub = document.getElementById("mainSub");

    let idx = 0;
    let score = 0;
    const answers = new Array(QUESTIONS.length).fill(null); // store selected option index

    function setFeedback(grade, text){
      feedbackEl.className = "feedback " + grade;
      feedbackEl.textContent = text;
    }

    function renderQuestion(){
      const Q = QUESTIONS[idx];
      progressPill.textContent = `Question ${idx+1} / ${QUESTIONS.length}`;
      scorePill.textContent = `Score: ${score}`;

      qText.textContent = Q.q;
      optionsEl.innerHTML = "";
      feedbackEl.className = "feedback";
      feedbackEl.textContent = "Pick one option üòè";

      nextBtn.disabled = true;
      backBtn.disabled = (idx === 0);

      Q.options.forEach((opt, i) => {
        const btn = document.createElement("button");
        btn.className = `opt ${opt.grade}`;
        btn.textContent = opt.label;

        // If already answered, show selected state + lock
        if (answers[idx] !== null) {
          btn.disabled = true;
          if (answers[idx] === i) {
            btn.style.transform = "scale(1.01)";
            btn.style.boxShadow = "0 0 0 3px rgba(216,27,96,.18), 0 12px 26px rgba(0,0,0,.10)";
          }
          nextBtn.disabled = false;
        }

        btn.addEventListener("click", () => pickAnswer(i));
        optionsEl.appendChild(btn);
      });

      // show feedback if answered earlier
      if (answers[idx] !== null) {
        const picked = QUESTIONS[idx].options[answers[idx]];
        setFeedback(picked.grade, picked.msg);
      }
    }

    function pickAnswer(optionIndex){
      if (answers[idx] !== null) return; // already answered

      answers[idx] = optionIndex;
      const picked = QUESTIONS[idx].options[optionIndex];

      // scoring: good = +1, warn = +0, bad = +0
      if (picked.correct) score += 1;

      // lock all option buttons
      [...optionsEl.querySelectorAll("button")].forEach(b => b.disabled = true);

      setFeedback(picked.grade, picked.msg);
      nextBtn.disabled = false;

      // effects based on result
      spawnFloaters(picked.grade === "good" ? 10 : 4);
      if (picked.grade === "good") { confettiBurst(140); fireworks(1); }
    }

    backBtn.addEventListener("click", () => {
      if (idx > 0) {
        idx--;
        renderQuestion();
      }
    });

    nextBtn.addEventListener("click", () => {
      if (idx < QUESTIONS.length - 1) {
        idx++;
        renderQuestion();
      } else {
        // move to love scene
        showLoveScene();
      }
    });

    function showLoveScene(){
      quizScene.classList.remove("active");
      loveScene.classList.add("active");
      mainTitle.textContent = "Final Question üòàüíñ";
      mainSub.textContent = "You survived the quiz‚Ä¶ now answer this üòè";

      // Extra effects
      confettiBurst(220);
      fireworks(2);
      spawnFloaters(18);

      // Start No button inside bounds
      setTimeout(moveNoButton, 350);
    }

    /***********************
     * Love Scene Logic (No runs away)
     ***********************/
    const arena = document.getElementById("arena");
    const noBtn = document.getElementById("noBtn");
    const yesBtn = document.getElementById("yesBtn");
    const finalText = document.getElementById("finalText");

    const noTexts = [
      "No üôÉ",
      "Are you sure? üòè",
      "Think again ü§≠",
      "Nope üòà",
      "Last chance ü•∫",
      "Error 404: No not found üòÇ",
      "Nice try üòå",
      "Not allowed üö´üòÑ"
    ];
    let noAttempts = 0;
    let loveLocked = false;

    function moveNoButton(){
      const r = arena.getBoundingClientRect();
      const w = noBtn.offsetWidth;
      const h = noBtn.offsetHeight;

      const pad = 10;
      const maxX = Math.max(pad, Math.floor(r.width  - w - pad));
      const maxY = Math.max(pad, Math.floor(r.height - h - pad));

      noBtn.style.left = rand(pad, maxX) + "px";
      noBtn.style.top  = rand(pad, maxY) + "px";
      noBtn.style.transform = "none";
    }

    function lockToYes(fromNo){
      if (loveLocked) return;
      loveLocked = true;

      finalText.textContent = fromNo
        ? "I know you love me üòåüíñ"
        : "Yayyy üò≠üíñ I love you too, Kutty ma!";

      confettiBurst(320);
      fireworks(3);
      spawnFloaters(28);

      yesBtn.disabled = true;
      noBtn.disabled = true;
